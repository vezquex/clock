<!doctype html>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='theme-color' content='#000000'>
<title>
	Frans Character Set
</title>
<style type='text/css'>
	:root {
		color-scheme: dark;
	}
	* {
		box-sizing: border-box;
	}
	body {
		background: #111;
		margin: 0;
		overflow-x: hidden;
	}
	.grow {
		flex-grow: 1;
	}
	.column {
		display: flex;
		flex-direction: column;
	}
</style>

<div class='column' style='min-height:100vh;'>
	<div id='face_box' class='grow'>
		<canvas id='face'></canvas>
	</div>
</div>

<script type='text/javascript'>
const {floor, max, min} = Math

let palettes
const color_palettes = {
	'black': '#000000',
	'gray_1_3': '#804040',
	'gray_2_3': '#5555A5',
	'white': '#F1EDDB',
}

const themes = {
	Dark: {
		_scale: ['black', 'gray_1_3', 'gray_2_3', 'white'],
		_body: '3',
		background: color_palettes.black,
		color: color_palettes.white,
	},
}
for(k in themes){
	const theme = themes[k]
	;(theme._scale||[]).forEach((color, i)=>theme[i] = color_palettes[color])
	Object.assign(theme, color_palettes)
}

const p = 2
const ch = 5*p
const cw = 3*p
const grid_h = ch + p
const grid_w = cw + p
const grid_w2 = grid_w * 2
const hch = ch/2
const hcw = cw/2

const can = document.getElementById('face')
const c = can.getContext('2d')

const height = 37
const width = 53
const pad_h = 1
const pad_v = p

// zoom
let z = 1

can.height = height * z
can.width = width * z
c.setTransform(z, 0, 0, z, 0, 0)

function setTheme(theme){
	palettes = themes[theme]
	can.style.backgroundColor = palettes.background
	synchronize()
}
function synchronize(){
	window.clearTimeout(window.synchronizeTimeout)
	display()
}
function zeropad2(s){
	return ('0' + s).slice(-2)
}

const pad = .25
const dpad = pad*2
const hpad = pad/2
const chp = ch - pad
const cwp = cw - pad
const slope = 10.4125 / 6.5
const inset = 1.25 + hpad
const insetx = cw - inset
const insety = ch - inset
const seg_paths = {
	C1: [[p,0],[p,p],[2*p,p],[2*p,0]],
	C2: [[1.5*p,1.5*p],[2*p,2*p],[2*p,p]],
	C2N: [[1.5*p,1.5*p],[p,p],[2*p,p]],
	C2S: [[1.5*p,1.5*p],[p,2*p],[2*p,2*p]],
	C2W: [[1.5*p,1.5*p],[p,p],[p,2*p]],
	C3: [[1.5*p,2.5*p],[2*p,3*p],[2*p,2*p]],
	C3N: [[1.5*p,2.5*p],[p,2*p],[2*p,2*p]],
	C3S: [[1.5*p,2.5*p],[p,3*p],[2*p,3*p]],
	C3W: [[1.5*p,2.5*p],[p,2*p],[p,3*p]],
	C4: [[p,4*p],[p,3*p],[2*p,3*p]],
	C4E: [[1.5*p,3.5*p],[2*p,4*p],[2*p,3*p]],
	C4S: [[1.5*p,3.5*p],[p,4*p],[2*p,4*p]],
	C5: [[p,4*p],[p,5*p],[2*p,5*p],[2*p,4*p]],
	L1: [[.5*p,0],[p,0],[p,p],[0,p],[0,.5*p]],
	L1W: [[0,0],[.5*p,0],[0,.5*p]],
	L2: [[0,p],[p,2*p],[0,2*p]],
	L2E: [[0,p],[p,p],[p,2*p]],
	L3: [[.5*p,2.5*p],[p,3*p],[p,2*p]],
	L3N: [[.5*p,2.5*p],[0,2*p],[p,2*p]],
	L3S: [[.5*p,2.5*p],[0,3*p],[p,3*p]],
	L3W: [[.5*p,2.5*p],[0,2*p],[0,3*p]],
	L4: [[0,3*p],[0,4*p],[p,4*p],[p,3*p]],
	L4W: [[0,0]],
	L5: [[0,4*p],[p,4*p],[p,5*p],[.5*p,5*p],[0,4.5*p]],
	L5E: [[p,0],[.5*p,0],[p,p]],
	L5W: [[0,4.5*p],[.5*p,5*p],[0,5*p]],
	R1: [[2*p,0],[2*p,p],[3*p,p],[3*p,.5*p],[2.5*p,0]],
	R1E: [[2.5*p,0],[3*p,0],[3*p,.5*p]],
	R2: [[2*p,p],[2*p,2*p],[3*p,2*p],[3*p,p]],
	R3: [[2.5*p,2.5*p],[3*p,3*p],[3*p,2*p]],
	R3N: [[2.5*p,2.5*p],[2*p,2*p],[3*p,2*p]],
	R3S: [[2.5*p,2.5*p],[2*p,3*p],[3*p,3*p]],
	R3W: [[2.5*p,2.5*p],[2*p,2*p],[2*p,3*p]],
	R4: [[2*p,3*p],[2*p,4*p],[3*p,4*p],[3*p,3*p]],
	R4E: [[0,0]],
	R5: [[2*p,4*p],[3*p,4*p],[3*p,4.5*p],[2.5*p,5*p],[2*p,5*p]],
	R5E: [[3*p,4.5*p],[3*p,5*p],[2.5*p,5*p]],
	R5W: [[0,0],[.5*p,0],[0,p]],
}
const seg_order = [
'L1W','R1E',
'L2E',
'C2N','C2S','C2W',
'L3N','L3S','L3W',
'C3N','C3S','C3W',
'R3N','R3S','R3W',
'L4W',
'C4E','C4S',
'R4E',
'L5W','L5E',
'R5W','R5E',
'L1','C1','R1',
'L2','C2','R2',
'L3','C3','R3',
'L4','C4','R4',
'L5','C5','R5',
].reverse()
const char_masks = {
	'□': 0b11111111111111111111111111111111111111n,
	' ': 0n,
	'0': 0b111101101101111n,
	'1': 0b1100000110010010010010n,
	'2': 0b1001111001111100111n,
	'3': 0b111001011001111n,
	'4': 0b1101101111001001n,
	'5': 0b111100111001111n,
	'6': 0b111100111101111n,
	'7': 0b111001010100100n,
	'8': 0b111101111101111n,
	'9': 0b111101111001111n,
	'[': 0b1100000011010010010011n,
	']': 0b1100000110010010010110n,
	'\\':0b10000000000000000000000100000010001001n,
	';': 0b1100000000010000010010n,
	"'": 0b010010000000000n,
	',': 0b1100000000000000010010n,
	'.': 0b000000000000010n,
	'/': 0b001001010100100n,
	'{': 0b1100000011010110010011n,
	'}': 0b1100000110010011010110n,
	'|': 0b1100000010010010010010n,
	':': 0b1100000000010000010000n,
	'"': 0b101101000000000n,
	'<': 0b1100000001010100010001n,
	'>': 0b1100000100010001010100n,
	'?': 0b111001010000010n,
	'`': 0b10110100000000000000000100000000000000n,
	'-': 0b000000111000000n,
	'=': 0b1100000000111000111000n,
	'~': 0b000110011000000n,
	'!': 0b010010010000010n,
	'¡': 0b1100000010000010010010n,
	'@': 0b111001111101111n,
	'#': 0b1100000010111010111010n,
	'$': 0b010111111111010n,
	'%': 0b101001010100101n,
 	'^': 0b010101000000000n,
	'&': 0n,
	'*': 0b101010101000000n,
	'(': 0b1100000001010010010001n,
	')': 0b1100000100010010010100n,
	'_': 0b000000000000111n,
	'+': 0b1100000000010111010000n,
	'A': 0b1001111101111101101n,
	'B': 0b1000111101111101111n,
	'C': 0b111100100100111n,
	'D': 0b1000111101101101111n,
	'E': 0b1001111100110100111n,
	'F': 0b1000111100110100100n,
	'G': 0b111100101101111n,
	'H': 0b1001101101111101101n,
	'I': 0b1100000010010010010010n,
	'J': 0b001001001101111n,
	'K': 0b1001101101110101101n,
	'L': 0b1100100100100111n,
	'M': 0b1001101111111101101n,
	'N': 0b1000000101111111111101n,
	'O': 0b111101101101111n,
	'P': 0b1000111101111100100n,
	'Q': 0b1111101101111111n,
	'R': 0b1000111101111101101n,
	'S': 0b111100111001111n,
	'T': 0b1100000111010010010010n,
	'U': 0b101101101101111n,
	'V': 0b1100000101101101111010n,
	'W': 0b1100000101101101111101n,
	'X': 0b101101111101101n,
	'Y': 0b1100000101101111010010n,
	'Z': 0b1111011110100111n,
}
const segs = seg_order.map(k => seg_paths[k])
const char_paths = Object.fromEntries(
	Object.entries(char_masks).map(
		([k, mask], i) => [k, mask_segs(mask, segs)]
	)
)

function mask_segs(mask, segs){
	let s = []
	let i = 0
	while(mask){
		if(mask & 1n){
			s.push(segs[i])
		}
		++i
		mask >>= 1n
	}
	return s
}
function shape(path, x, y, m = 1){
	m = m*z
	c.beginPath()
	c.moveTo((path[0][0] + x)*m, (path[0][1] + y)*m)
	for(i=1; i<path.length; ++i){
		c.lineTo((path[i][0] + x)*m, (path[i][1] + y)*m)
	}
	c.fill()
}
function draw_char(s, x, y, m = 1, paths = char_paths){
	(paths[s] || paths['□']).forEach(
		path => shape(path, x, y, m)
	)
}
function draw_str(chars, x, y, m = 1, paths, gw = grid_w){
	if(!(chars instanceof Array)){
		chars = (chars+'').split('')
	}
	chars.forEach((s, i) => {
		draw_char(s, x + i * gw, y, m, paths)
	})
}

const face_box = document.getElementById('face_box')
function resize(event){
	const scale = window.devicePixelRatio || 1
	const face_box_height = floor(window.innerHeight) - 1
	z = max(1, floor(min(
		window.innerWidth / width,
		face_box_height / height,
	)))
	face_box.style.height = face_box_height + 'px'
	can.height = height * scale * z
	can.width = width * scale * z
	can.style.height = (height*z)+'px'
	can.style.width = (width*z)+'px'
	c.scale(scale, scale)
	synchronize()
}

window.addEventListener('resize', resize)
window.screen.orientation.addEventListener('change', resize)

function display(t){
	c.fillStyle = palettes.color
	c.clearRect(0, 0, width*z, height*z)
	let x = pad_h, y = pad_v - grid_h, m = .5
	const out = `\`1234567890-=~!@#$%^&*()_+[]\\;',./    □{}|:"<>?¡    ABCDEFGHIJKLMNOPQRSTUVWXYZ`
	let i = 0
	let w = 13
	;[...Array(8)].forEach(() =>
		draw_str(out.slice(i, i+=w), x/m, y+=grid_h, m)
	)
}

setTheme('Dark')
resize()

</script>