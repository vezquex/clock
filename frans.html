<!doctype html>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='theme-color' content='#000000'>
<title>
	Frans Character Set
</title>
<style type='text/css'>
	:root {
		color-scheme: dark;
	}
	* {
		box-sizing: border-box;
	}
	body {
		background: #111;
		margin: 0;
		overflow-x: hidden;
	}
	.grow {
		flex-grow: 1;
	}
	.column {
		display: flex;
		flex-direction: column;
	}
</style>

<div class='column' style='min-height:100vh;'>
	<div id='face_box' class='grow'>
		<canvas id='face'></canvas>
	</div>
</div>

<script type='text/javascript'>
const {floor, max, min} = Math

let palettes
const color_palettes = {
	'black': '#000000',
	'gray_1_3': '#804040',
	'gray_2_3': '#5555A5',
	'white': '#F1EDDB',
}

const themes = {
	Dark: {
		_scale: ['black', 'gray_1_3', 'gray_2_3', 'white'],
		_body: '3',
		background: color_palettes.black,
		color: color_palettes.white,
	},
}
for(k in themes){
	const theme = themes[k]
	;(theme._scale||[]).forEach((color, i)=>theme[i] = color_palettes[color])
	Object.assign(theme, color_palettes)
}

const p = 2
const ch = 10
const cw = 6
const grid_h = ch + p
const grid_w = cw + p
const grid_w2 = grid_w * 2
const hch = ch/2
const hcw = cw/2

const can = document.getElementById('face')
const c = can.getContext('2d')

const height = 37
const width = 53
const pad_h = 1
const pad_v = p

// zoom
let z = 1

can.height = height * z
can.width = width * z
c.setTransform(z, 0, 0, z, 0, 0)

function setTheme(theme){
	palettes = themes[theme]
	can.style.backgroundColor = palettes.background
	synchronize()
}
function synchronize(){
	window.clearTimeout(window.synchronizeTimeout)
	display()
}
function zeropad2(s){
	return ('0' + s).slice(-2)
}

let x, y
const seg_paths = {
	C1: [[2,0],[2,2],[4,2],[4,0]],
	C2: [[3,3],[4,4],[4,2]],
	C2N: [[3,3],[2,2],[4,2]],
	C2S: [[3,3],[2,4],[4,4]],
	C2W: [[3,3],[2,2],[2,4]],
	C3: [[3,5],[4,6],[4,4]],
	C3N: [[3,5],[2,4],[4,4]],
	C3S: [[3,5],[2,6],[4,6]],
	C3W: [[3,5],[2,4],[2,6]],
	C4: [[2,8],[2,6],[4,6]],
	C4E: [[3,7],[4,8],[4,6]],
	C4S: [[3,7],[2,8],[4,8]],
	C5: [[2,8],[2,10],[4,10],[4,8]],
	L1: [[1,0],[2,0],[2,2],[0,2],[0,1]],
	L1W: [[0,0],[1,0],[0,1]],
	L2: [[0,2],[2,4],[0,4]],
	L2E: [[0,2],[2,2],[2,4]],
	L3: [[1,5],[2,6],[2,4]],
	L3N: [[1,5],[0,4],[2,4]],
	L3S: [[1,5],[0,6],[2,6]],
	L3W: [[1,5],[0,4],[0,6]],
	L4: [[0,6],[1,8],[2,8],[2,6]],
	L4W: [[0,6],[0,8],[1,8]],
	L5: [[x=0,y=8],[x+1,y],[x+2,y+=2],[x+1,y],[x,y-1]],
	L5E: [[x=2,y=8],[x-1,y],[x,y+2]],
	L5W: [[x=0,y=10],[x,y-1],[x+1,y]],
	R1: [[4,0],[4,2],[6,2],[6,1],[5,0]],
	R1E: [[5,0],[6,0],[6,1]],
	R2: [[4,2],[4,4],[6,4],[6,2]],
	R3: [[5,5],[6,6],[6,4]],
	R3N: [[5,5],[4,4],[6,4]],
	R3S: [[5,5],[4,6],[6,6]],
	R3W: [[5,5],[4,4],[4,6]],
	R4: [[4,6],[6,6],[5,8],[4,8]],
	R4E: [[6,6],[6,8],[5,8]],
	R5: [[x=4,y=10],[x+1,y],[x+=2,y-1],[x,y-=2],[x-1,y]],
	R5E: [[x=6,y=10],[x-1,y],[x,y-1]],
	R5W: [[x=4,y=8],[5,y],[x,y+2]],
}
const seg_order = [
'L1W','R1E',
'L2E',
'C2N','C2S','C2W',
'L3N','L3S','L3W',
'C3N','C3S','C3W',
'R3N','R3S','R3W',
'L4W',
'C4E','C4S',
'R4E',
'L5W','L5E',
'R5W','R5E',
'L1','C1','R1',
'L2','C2','R2',
'L3','C3','R3',
'L4','C4','R4',
'L5','C5','R5',
].reverse()
const char_masks = {
	'□': 0b11111111111111111111111111111111111111n,
	' ': 0n,
	'0': 0b00101011110011110010110111101101101111n,
	'1': 0b00011100011100001100000110010010010010n,
	'2': 0b00000001011110110001111111001110100111n,
	'3': 0b00000000011111100010110111001010001111n,
	'4': 0b11100010011111100010011101101111001001n,
	'5': 0b11100011111101100010110111100110001111n,
	'6': 0b00100011111101110010110111100110101111n,
	'7': 0b11000000001010101100000111001010010010n,
	'8': 0b00100011011111110010110111101110101111n,
	'9': 0b00100010011111100010110111101111001111n,
	'[': 0b01011100011100001100011011010010010011n,
	']': 0b10011100011100001101100110010010010110n,
	'\\':0b00101100010001100010010100000010001001n,
	';': 0b00011100000000001100000000010000010010n,
	"'": 0b00011100000000000000000010010000000000n,
	',': 0b00000000000000001100000000000000010010n,
	'.': 0b000000000000010n,
	'/': 0b00001001011110110000100001011110110100n,
	'{': 0b01011100011100001100011011010100010011n,
	'}': 0b10011100011000101101100110010010010110n,
	'|': 0b00011100011100001100000010010010010010n,
	':': 0b00011100000000001100000000010000010000n,
	'"': 0b11100000000000000000000101101000000000n,
	'<': 0b00001000011100001000000000010100000000n,
	'>': 0b00001100011000100000000000000010010000n,
	'?': 0b00000000001010100000000111001010000010n,
	'`': 0b00101100010000100000000000000010000000n,
	'-': 0b00000011111111100000000000000111000000n,
	'=': 0b00111100000000011110000000111000111000n,
	'~': 0b00101100010011100000000000100011000000n,
	'!': 0b00011100011100000000000010010010000010n,
	'¡': 0b00000000011100001100000010000010010010n,
	'@': 0b00000001011111110010110111001111101111n,
	'#': 0b00111100011100011110000010111010111010n,
	'$': 0b00110110001100011110000010111100111010n,
	'%': 0b00001001011110110000110101011110110101n,
 	'^': 0b00001001010101100000000000000110000000n,
	'&': 0b00101011011101111110110111111111101110n,
	'*': 0b00001011011111100000000000010110010000n,
	'⚡': 0b00001000011100100000000000010110010000n,
	'(': 0b00011100011100001100010001010000010001n,
	')': 0b00011100011000001100100100010010010100n,
	'_': 0b00000000000000000001111000000000000111n,
	'+': 0b00011111111111101100000000010111010000n,
	'A': 0b00100011111111110011111111101111101101n,
	'B': 0b10100011111111110011110111101110101111n,
	'C': 0b00100011100000010000110111100100100111n,
	'D': 0b10100011100011110011110111101101101111n,
	'E': 0b11100011111100010001111111100110100111n,
	'F': 0b11100011111100010001100111100110100100n,
	'G': 0b00100011100011110010110111100111101111n,
	'H': 0b11100011111111110011111101101111101101n,
	'I': 0b11011100011100001101111111010010010111n,
	'J': 0b01000000000011110010110001001001101111n,
	'K': 0b11101011111101110011111101111110101101n,
	'L': 0b10100011100000010000111100100100100111n,
	'M': 0b11101111110011110011111101111101101101n,
	'N': 0b11101111110011110011111101101111101101n,
	'O': 0b00100011100011110010110111101101101111n,
	'P': 0b00100011111110110001100111101110100100n,
	'Q': 0b00100011100011110000111111101101101111n,
	'R': 0b10100011111111110011111111101110101101n,
	'S': 0b00100010011101100010110111100110001111n,
	'T': 0b11011100011100001100000111010010010010n,
	'U': 0b11100011100011110010110101101101101111n,
	'V': 0b11100011100011101100110101101101111010n,
	'W': 0b11100011101011111011111101101101111101n,
	'X': 0b11101111011111111011111101111110111101n,
	'Y': 0b11100010001110101100000101101110010010n,
	'Z': 0b11001001011110110001111111011110110111n,
}
const segs = seg_order.map(k => seg_paths[k])
const char_paths = Object.fromEntries(
	Object.entries(char_masks).map(
		([k, mask], i) => [k, mask_segs(mask, segs)]
	)
)
const svg = s => {
	return `<svg alt='${s}' viewBox='0 0 ${
		grid_w*s.length-p} ${ch}'>${
		s.split('').map((c,i)=>
			`<g transform='translate(${grid_w*i})'>${
				char_paths[c].map(p=>`<path d='M${p[0]}L${p.slice(1)}z'/>`).join('')
			}</g>`
	).join('')
	}</svg>`
}
// console.log(svg('38-SEGMENT CHARACTERS'))
function mask_segs(mask, segs){
	let s = []
	let i = 0
	while(mask){
		if(mask & 1n){
			s.push(segs[i])
		}
		++i
		mask >>= 1n
	}
	return s
}
function shape(path, x, y, m = 1){
	m = m*z
	c.beginPath()
	c.moveTo((path[0][0] + x)*m, (path[0][1] + y)*m)
	for(i=1; i<path.length; ++i){
		c.lineTo((path[i][0] + x)*m, (path[i][1] + y)*m)
	}
	c.fill()
}
function draw_char(s, x, y, m = 1, paths = char_paths){
	(paths[s] || paths['□']).forEach(
		path => shape(path, x, y, m)
	)
}
function draw_str(chars, x, y, m = 1, paths, gw = grid_w){
	if(!(chars instanceof Array)){
		chars = (chars+'').split('')
	}
	chars.forEach((s, i) => {
		draw_char(s, x + i * gw, y, m, paths)
	})
}

const face_box = document.getElementById('face_box')
function resize(event){
	const scale = window.devicePixelRatio || 1
	const face_box_height = floor(window.innerHeight) - 1
	z = max(1, floor(min(
		window.innerWidth / width,
		face_box_height / height,
	)))
	face_box.style.height = face_box_height + 'px'
	can.height = height * scale * z
	can.width = width * scale * z
	can.style.height = (height*z)+'px'
	can.style.width = (width*z)+'px'
	c.scale(scale, scale)
	synchronize()
}

window.addEventListener('resize', resize)
window.screen.orientation.addEventListener('change', resize)

function display(t){
	c.fillStyle = palettes.color
	c.clearRect(0, 0, width*z, height*z)
	let x = pad_h, y = pad_v - grid_h, m = .5
	const out = `\`1234567890-=~!@#$%^&*()_+[]\\;',./⚡   □{}|:"<>?¡    ABCDEFGHIJKLMNOPQRSTUVWXYZ`
	let i = 0
	let w = 13
	;[...Array(8)].forEach(() =>
		draw_str(out.slice(i, i+=w), x/m, y+=grid_h, m)
	)
}

setTheme('Dark')
resize()

</script>