<!doctype html>
<meta charset='utf-8'/>
<meta name='viewport' content='width=device-width' />
<meta name='theme-color' content='#000000'/>
<title>
	More Pixel Fonts
</title>
<style type='text/css'>
	:root {color-scheme: dark;}
	body, input, select {
		background: #000;
		color: #FFF;
		display: flex;
		flex-direction: column;
		font-family: sans-serif;
		font-size: 1em;
		margin: 0;
	}
	label {
		display: flex;
	}
	input, select, .label {
		border: 0;
		opacity: 0.5;
		padding: .5em;
	}
	select {
		flex-grow: 1;
	}
</style>

<input id='offset' title='Demo Offset' value='0' type='range' max='86400000' step='100000' onInput='synchronize()'>
<label>
	<span class='label'>Theme</span>
	<select id='theme' onChange='setTheme(this.value)'></select>
</label>
<div><canvas id='face'></canvas></div>

<script type='text/javascript'>

let palettes

const color_palettes = {
	'black': {
		1: '#242224',
	},
	'gray_1_3': {
		1: '#4F4D47',
	},
	'gray_2_3': {
		1: '#9E9B8F',
	},
	'white': {
		1: '#F1EDDB',
	},
}
const four_negative = ['black', 'gray_1_3', 'gray_2_3', 'white']
const four_positive = [...four_negative].reverse()
const themes = {
	Dark: {
		_scale: four_negative,
		_body: '3',
		background: color_palettes.black[1],
	},
	Light: {
		_scale: four_positive,
		_body: '3',
		background: color_palettes.white[1],
	},
}
for(k in themes){
	const theme = themes[k]
	;(theme._scale ?? []).forEach((color, i)=>theme[i] = color_palettes[color])
	Object.assign(theme, color_palettes)
}
document.getElementById('theme').innerHTML = Object.keys(themes).map(t => `<option value='${t}'>${t}</option>`).join('')


const locale = 'en-us'
const months = ['JAN.', 'FEB.', 'MAR.', 'APR.', 'MAY', 'JUNE', 'JULY', 'AUG.', 'SEPT', 'OCT.', 'NOV.', 'DEC.']

const _ = void 0

const can = document.getElementById('face')
const c = can.getContext('2d')

const height = 300
const width = 306
const pad_horizon = 0
const pad_vertical = 5

// zoom dev
const z = 3
can.height = height * z
can.width = width * z
c.setTransform(z, 0, 0, z, 0, 0)

const offset_el = document.getElementById('offset')

function slots_h(grid){ return Math.floor((width - pad_horizon) / grid) }

const decode_font = (area) => (s) => s.replace(/\s/g, '').padEnd(area, '0').split('').map(s=>parseInt(s))
const fonts_decode = {}
const fonts_dimension = {}
const fonts = {}

function dim_area(o){ return o.h * o.w }
function dim_grid_height(o){ return o.h + (o.pad ?? 1) }
function dim_grid_width(o){ return o.w + (o.pad ?? 1) }

fonts_dimension.mip_7 = {h:7, w:5}
fonts_decode.mip_7 = decode_font(dim_area(fonts_dimension.mip_7))
fonts.mip_7 = {
	"missing":`
	10101
	01010
	10101
	01010
	10101
	01010
	10101
	`,
	"0":`
	01110
	10001
	10001
	10101
	10001
	10001
	01110
	`,
	"1":`
	00100
	01100
	00100
	00100
	00100
	00100
	01110
	`,
	"2":`
	01110
	10001
	00001
	00010
	00100
	01000
	11111
	`,
	"3":`
	01110
	10001
	00001
	01110
	00001
	10001
	01110
	`,
	"4":`
	00010
	00110
	01010
	10010
	11111
	00010
	00010
	`,
	"5":`
	11111
	10000
	10000
	11110
	00001
	10001
	01110
	`,
	"6":`
	01110
	10001
	10000
	11110
	10001
	10001
	01110
	`,
	"7":`
	11111
	10001
	00001
	00010
	00100
	00100
	00100
	`,
	"8":`
	01110
	10001
	10001
	01110
	10001
	10001
	01110
	`,
	"9":`
	01110
	10001
	10001
	01111
	00001
	10001
	01110
	`,
	"A":`
	00100
	01010
	10001
	10001
	11111
	10001
	10001
	`,
	"B":`
	11110
	10001
	10001
	11110
	10001
	10001
	11110
	`,
	"C":`
	01111
	10000
	10000
	10000
	10000
	10000
	01111
	`,
	"D":`
	11110
	10001
	10001
	10001
	10001
	10001
	11110
	`,
	"E":`
	11111
	10000
	10000
	11110
	10000
	10000
	11111
	`,
	"F":`
	11111
	10000
	10000
	11110
	10000
	10000
	10000
	`,
	"G":`
	01111
	10000
	10000
	10011
	10001
	10001
	01111
	`,
	"H":`
	10001
	10001
	10001
	11111
	10001
	10001
	10001
	`,
	"I":`
	01110
	00100
	00100
	00100
	00100
	00100
	01110
	`,
	"J":`
	00001
	00001
	00001
	00001
	00001
	10001
	01110
	`,
	"K":`
	10001
	10010
	10100
	11000
	10100
	10010
	10001
	`,
	"L":`
	10000
	10000
	10000
	10000
	10000
	10000
	11111
	`,
	"M":`
	10001
	11011
	10101
	10101
	10001
	10001
	10001
	`,
	"N":`
	10001
	11001
	10101
	10101
	10011
	10001
	10001
	`,
	"O":`
	01110
	10001
	10001
	10001
	10001
	10001
	01110
	`,
	"P":`
	11110
	10001
	10001
	11110
	10000
	10000
	10000
	`,
	"Q":`
	01110
	10001
	10001
	10001
	10101
	10010
	01101
	`,
	"R":`
	11110
	10001
	10001
	11110
	10100
	10010
	10001
	`,
	"S":`
	01110
	10001
	10000
	01110
	00001
	10001
	01110
	`,
	"T":`
	11111
	00100
	00100
	00100
	00100
	00100
	00100
	`,
	"U":`
	10001
	10001
	10001
	10001
	10001
	10001
	01110
	`,
	"V":`
	10001
	10001
	10001
	10001
	10001
	01010
	00100
	`,
	"W":`
	10001
	10001
	10001
	10101
	10101
	01010
	01010
	`,
	"X":`
	10001
	10001
	01010
	00100
	01010
	10001
	10001
		`,
	"Y":`
	10001
	10001
	10001
	01010
	00100
	00100
	00100
	`,
	"Z":`
	11111
	00001
	00010
	00100
	01000
	10000
	11111
	`,
	"-":`
	00000
	00000
	00000
	11111
	00000
	00000
	00000
	`,
	"_":`
	00000
	00000
	00000
	00000
	00000
	00000
	11111
	`,
	".":`
	00000
	00000
	00000
	00000
	00000
	00100
	00100
	`,
	"/":`
	00010
	00010
	00110
	00100
	01100
	01000
	01000
	`,
	"ïŠ”":`
	00100
	10110
	01101
	00110
	01101
	10110
	00100
	`,
}

fonts_dimension.mip_10 = {h:10, w:8}
fonts_decode.mip_10 = decode_font(dim_area(fonts_dimension.mip_10))
fonts.mip_10 = {
	"missing":`
		11001100
		11001100
		00110011
		00110011
		11001100
		11001100
		00110011
		00110011
		11001100
		11001100
	`,
	"H":`
		11000011
		11000011
		11000011
		11000011
		11111111
		11111111
		11000011
		11000011
		11000011
		11000011
	`,
	"T":`
		11111111
		11111111
		00011000
		00011000
		00011000
		00011000
		00011000
		00011000
		00011000
		00011000
	`,
	"U":`
		11000011
		11000011
		11000011
		11000011
		11000011
		11000011
		11000011
		11000011
		11111111
		01111110
	`,
	"p":`
		00000000
		11111110
		11111111
		11000011
		11000011
		11111111
		11111110
		11000000
		11000000
		11000000
	`,
	"/":`
		00000011
		00000110
		00001100
		00011000
		00110000
		01100000
		11000000
	`,
}

fonts_dimension.mip_15 = {h:15, w:11, pad: 4}
fonts_decode.mip_15 = decode_font(dim_area(fonts_dimension.mip_15))
fonts.mip_15 = {
	"0": `
		00111111100
		11111111111
		11111111111
		11100000111
		11100000111
		11100000111
		11100000111
		11100000111
		11100000111
		11100000111
		11100000111
		11100000111
		11111111111
		11111111111
		00111111100
	`,
	"1": `
		00000001111
		00000011111
		00000111111
		00000111111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
		00000000111
	`,
	"2": `
		01111111110
		11111111111
		11111111111
		11100000111
		00000000111
		00000000111
		00111111111
		01111111111
		11111111110
		11100000000
		11100000000
		11100000111
		11111111111
		11111111111
		11111111111
	`,
	"3": `
		00111111100
		11111111111
		11111111111
		11100000111
		11100000111
		00000000111
		00000111111
		00000111110
		00000111111
		00000000111
		11100000111
		11100000111
		11111111111
		11111111111
		00111111100
	`,
	"4": `
		00000001110
		00000011110
		00000111110
		00001111110
		00011111110
		00111101110
		01111001110
		11110001110
		11100001110
		11111111111
		11111111111
		11111111111
		00000001110
		00000001110
		00000001110
	`,
		"5": `
		11111111111
		11111111111
		11111111111
		11100000000
		11100000000
		11100000000
		11111111110
		11111111111
		11111111111
		00000000111
		00000000111
		11100000111
		11111111111
		11111111111
		00111111100
	`,
	"6": `
		00111111100
		01111111110
		11111111111
		11100000111
		11100000000
		11100000000
		11111111110
		11111111111
		11111111111
		11100000111
		11100000111
		11100000111
		11111111111
		01111111110
		00111111100
	`,
	"7": `
		11111111111
		11111111111
		11111111111
		11100000111
		00000000111
		00000001110
		00000001110
		00000011100
		00000011100
		00000111000
		00000111000
		00001110000
		00001110000
		00001110000
		00001110000
	`,
	"8": `
		00111111100
		11111111111
		11111111111
		11100000111
		11100000111
		11100000111
		11111111111
		01111111110
		11111111111
		11100000111
		11100000111
		11100000111
		11111111111
		11111111111
		00111111100
	`,
	"9": `
		00111111100
		11111111111
		11111111111
		11100000111
		11100000111
		11100000111
		11111111111
		11111111111
		01111111111
		00000000111
		00000000111
		11100000111
		11111111111
		11111111111
		00111111100
	`,
	"missing": `
		01111111110
		11111111111
		01111111110
		00111111100
		01111111110
		11111111111
		01111111110
		00111111100
		01111111110
		11111111111
		01111111110
		00111111100
		01111111110
		11111111111
		01111111110
	`,
	" ": ``,
}

fonts_dimension.mip_23 = {h:23, w:16, pad: 5 /*6*/}
fonts_decode.mip_23 = decode_font(dim_area(fonts_dimension.mip_23))
fonts.mip_23 = {
	"0": `
		0011111111111100
		0111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111110
		0011111111111100
	`,
	"1": `
		0000000000011111
		0000000000111111
		0000000001111111
		0000000001111111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
		0000000000001111
	`,
	"2": `
		0011111111111100
		0111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		0000000000011111
		0000000000011111
		0000000000011111
		0011111111111111
		0111111111111111
		1111111111111110
		1111111111111100
		1111100000000000
		1111100000000000
		1111100000000000
		1111100000000000
		1111100000000000
		1111100000011111
		1111111111111111
		1111111111111111
		1111111111111111
		1111111111111111
	`,
	"3": `
		0011111111111100
		0111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		0000000000011111
		0000000000011111
		0000000000011111
		0001111111111111
		0001111111111110
		0001111111111110
		0001111111111111
		0000000000011111
		0000000000011111
		0000000000011111
		0000000000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111110
		0011111111111100
	`,
	"4": `
		0000001111111100
		0000011111111100
		0000011111111100
		0000111111111100
		0000111101111100
		0001111101111100
		0001111001111100
		0011111001111100
		0011110001111100
		0111110001111100
		0111100001111100
		1111100001111100
		1111000001111100
		1111000001111100
		1111111111111111
		1111111111111111
		1111111111111111
		1111111111111111
		0000000001111100
		0000000001111100
		0000000001111100
		0000000001111100
		0000000001111100
	`,
		"5": `
		1111111111111111
		1111111111111111
		1111111111111111
		1111111111111111
		1111100000000000
		1111100000000000
		1111100000000000
		1111100000000000
		1111111111111110
		1111111111111111
		1111111111111111
		1111111111111111
		1111100000011111
		0000000000011111
		0000000000011111
		0000000000011111
		0000000000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111110
		0011111111111100
	`,
	"6": `
		0011111111111100
		0111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		1111100000000000
		1111100000000000
		1111100000000000
		1111111111111100
		1111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111110
		0011111111111100
	`,
	"7": `
		1111111111111111
		1111111111111111
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		0000000000011111
		0000000000011111
		0000000000011111
		0000000000111110
		0000000000111110
		0000000001111100
		0000000001111100
		0000000011111000
		0000000011111000
		0000000111110000
		0000000111110000
		0000001111100000
		0000001111100000
		0000001111100000
		0000001111100000
		0000001111100000
		0000001111100000
	`,
		"8": `
		0011111111111100
		0111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111111111111111
		0111111111111110
		0111111111111110
		1111111111111111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111110
		0011111111111100
	`,
	"9": `
		0011111111111100
		0111111111111110
		1111111111111111
		1111111111111111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111111
		0011111111111111
		0000000000011111
		0000000000011111
		0000000000011111
		0000000000011111
		1111100000011111
		1111100000011111
		1111111111111111
		1111111111111111
		0111111111111110
		0011111111111100
	`,
	"missing": `
		0111111111111110
		1111111111111111
		0111111111111110
		0011111111111100
		0111111111111110
		1111111111111111
		0111111111111110
		0011111111111100
		0111111111111110
		1111111111111111
		0111111111111110
		0011111111111100
		0111111111111110
		1111111111111111
		0111111111111110
		0011111111111100
		0111111111111110
		1111111111111111
		0111111111111110
		0011111111111100
		0111111111111110
		1111111111111111
		0111111111111110
	`,
	" ": ``,
	":":`
		0000000000000000
		0000000000000000
		0000000110000000
		0000001111000000
		0000001111000000
		0000001111000000
		0000001111000000
		0000000110000000
		0000000000000000
		0000000000000000
		0000000000000000
		0000000000000000
		0000000000000000
		0000000000000000
		0000000000000000
		0000000110000000
		0000001111000000
		0000001111000000
		0000001111000000
		0000001111000000
		0000000110000000
	`,
}

for(f in fonts){
	const decode = fonts_decode[f]
	if(!decode) continue
	const font = fonts[f]
	for(char in font){
		font[char] = decode(font[char])
	}
}

function setTheme(theme){
	palettes = themes[theme]
	document.getElementById('face').style.backgroundColor = palettes.background
	document.querySelector(`#theme [value=${theme}]`).selected = true
	synchronize()
}

function str(s, x = 0, y = 0, m = 1, p = palettes._body, f = font, ctx = c){
	s = [...s] // unicode
	for(var i = 0; i < s.length; ++i){
		symbol(
			s[i],
			x + i,
			y, m, p, f, ctx
		)
	}
}

function symbol(s, x, y, m, p, f, c = c){
	const font = fonts[f]
	const dim = fonts_dimension[f]
	const w = dim.w
	const cell = dim_grid_width(dim)
	const bmp = font[s] ?? font.missing ?? fonts.block.missing
	const l = bmp.length
	for(var i = 0; i < l; ++i){
		let b = bmp[i]
		if(b === 0) continue
		c.fillStyle = palettes[p][b]
		c.fillRect(
			m * (x * cell + (i % w)) + pad_horizon,
			(y + m * Math.floor(i / w)) + pad_vertical,
			m, m
		)
	}
}

// display at the start of each second
function synchronize(){
	window.clearTimeout(window.synchronizeTimeout)
	const offset = Number(offset_el.value)
	// const offset = 0
	const t = new Date(Date.now() + offset)
	// const t = new Date(offset)
	display(t)
	const r = 1000 - (t % 1000)
	// window.synchronizeTimeout = window.setTimeout(synchronize, r)
}

function zeropad2(s){
	return ('0' + s).slice(-2)
}

function tiles(font, y){
	const tile_dim = fonts_dimension[font]
	const grid_w = dim_grid_width(tile_dim)
	const slots = slots_h(dim_grid_width(tile_dim))
	for(var i = 0; i < slots; ++i){
		c.fillStyle = `rgba(127, 127, 127, ${15/255})`
		c.fillRect(
			i % slots * grid_w,
			y + pad_vertical,
			tile_dim.w,
			tile_dim.h,
		)
	}
}

function display(t){
	// const month = months[t.getMonth()]
	const month = t.toLocaleString(locale, { month: 'short' }).toUpperCase()
	const weekday = t.toLocaleString(locale, { weekday: 'long' }).toUpperCase()
	const hours = t.getHours()
	const minutes = t.getMinutes()
	const time = zeropad2(hours) + ':' + zeropad2(minutes)
	const seconds = zeropad2(t.getSeconds())
	const numdate =
		t.getFullYear()+
		'-'+
		zeropad2(t.getMonth() + 1)+
		'-'+
		zeropad2(t.getDate())

	c.clearRect(0, 0, width, height)

	let y = 0
	{
		const font = 'mip_23'
		tiles(font, y)
		str(time, 1, y, 1, _, font)
		str(seconds, 8.4, y+8, 1, '2', 'mip_15')
		y += pad_vertical + dim_grid_height(fonts_dimension[font])
	}
	{
		const font = 'mip_7'
		tiles(font, y)
		str(numdate, 0, y, _, _, font)
		console.log('month', month)
		str(month, 10, y, _, _, font)
		str(weekday.slice(0,3)+'.', 16, y, _, _, font)
		y += pad_vertical + dim_grid_height(fonts_dimension[font])
	}
	{
		const font = 'mip_23'
		tiles(font, y)
		const chars = Object.keys(fonts[font])
		const slots = slots_h(dim_grid_width(fonts_dimension[font]))
		for(var i = 0; i < chars.length / slots; ++i){
			str(
				chars.slice(
					i * slots,
					(i+1) * slots
				),
				0,
				y+i,
				_,
				_,
				font
			)
		}
		y += pad_vertical + dim_grid_height(fonts_dimension[font])
	}
	{
		const font = 'mip_15'
		tiles(font, y)
		const chars = Object.keys(fonts[font])
		const slots = slots_h(dim_grid_width(fonts_dimension[font]))
		for(var i = 0; i < chars.length / slots; ++i){
			str(
				chars.slice(
					i * slots,
					(i+1) * slots
				),
				0,
				y+i,
				_,
				_,
				font
			)
		}
		y += pad_vertical + dim_grid_height(fonts_dimension[font])
	}
	{
		const font = 'mip_10'
		tiles(font, y)
		const chars = Object.keys(fonts[font])
		const slots = slots_h(dim_grid_width(fonts_dimension[font]))
		for(var i = 0; i < chars.length / slots; ++i){
			str(
				chars.slice(
					i * slots,
					(i+1) * slots
				),
				0,
				y+i,
				1,
				2,
				font
			)
		}
		y += pad_vertical + dim_grid_height(fonts_dimension[font])
	}
	{
		const font = 'mip_7'
		tiles(font, y)
		const chars = Object.keys(fonts[font])
		const slots = slots_h(dim_grid_width(fonts_dimension[font]))
		for(var i = 0; i < chars.length / slots; ++i){
			str(
				chars.slice(
					i * slots,
					(i+1) * slots
				),
				0,
				y + i,
				1,
				3,
				font
			)
		}
		y += pad_vertical + dim_grid_height(fonts_dimension[font])
	}
}

setTheme('Dark')

synchronize()

</script>
